Improved functionality of an important function and fixing a CRAN check NOTE.

## Test environments
* local R installation, R 4.1.3
* win-builder (devel)

## R CMD check results

0 errors | 0 warnings | 0 notes
